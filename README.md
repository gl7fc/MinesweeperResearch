# Minesweeper Research / Difficulty Analyzer

マインスイーパのパズル生成 , および各セルの「論理的な難易度」を定量的に解析するJava製ツールです. 
Knuth's Algorithm X (Dancing Links) を用いた制約充足ソルバをバックエンドに使用し , パズルが論理的に解けるかどうか , また解くためにどのような思考やテクニックが必要かを判定します. 

## 主な機能

1.  **パズル自動生成 & 最小化**
    * ランダムな盤面生成に加え , ヒント数を限界まで減らす「最小化アルゴリズム」を搭載しています. 
    * 正解が一意に定まることを保証しながら , 高難易度なパズルを作成します. 

2.  **難易度解析 (Dual Analysis)**
    * **A. Hint Count Difficulty ($k$-Hint)**: 同時参照が必要なヒント数に基づく計算量的難易度. 
    * **B. Technique Level Difficulty**: 人間の思考パターン（定石）に基づく認知的難易度. 

3.  **詳細ログ出力**
    * 解析プロセスをCSV出力し , どのヒントからどのセルが確定したかを追跡可能です. 

## アルゴリズム詳細

### 1. パズル生成と最小化 (Puzzle Generation)

本ツールは単にランダムに地雷を置くだけでなく , 以下の手順で「解ける問題」を生成します. 

* **Step 1: ランダム生成 (`PuzzleGenerator`)**
    * 指定サイズ・地雷数でランダムに地雷を配置し , 全てのセルを開いた状態（完全なヒントがある状態）の正解盤面を作成します. 
* **Step 2: ヒントの削減 (`PuzzleMinimizer`)**
    * 正解盤面のヒント数字（Safeセル）をランダムな順序で一つずつ「隠す（Unknown状態にする）」ことを試みます. 
    * 隠すたびに , バックグラウンドで **DLXソルバ** を起動し , 「その盤面の解が一意（ただ1つ）であるか」を判定します. 
    * もし解が複数存在する場合（運ゲーになる場合）は , そのヒントを隠すのをやめて元に戻します. 
    * これを全セルに対して行うことで , 論理的に解けるギリギリまでヒントが削ぎ落とされた問題盤面が完成します. 

### 2. 制約充足ソルバ (Dancing Links / DLX)

解析の核となるのが `DancingLinks` クラスです. これは Donald Knuth 氏の "Algorithm X" を実装したものです. 

* **Exact Cover Problem (完全被覆問題)**
    * マインスイーパのルール（「このマスの周囲8マスのうち地雷はN個」）を , 0と1からなる巨大な行列（制約行列）に変換します. 
    * `ConstraintBuilder` クラスがこの変換を担当し , 盤面の状態を「変数（各マスの地雷有無）」と「制約（ヒント数字）」の行列形式で表現します. 
* **高速バックトラッキング**
    * DLXは , 行列の要素を「上下左右に連結されたノード」として表現することで , 行や列の削除・復元を高速に行います. 
    * これにより , 膨大な組み合わせの中から , すべてのヒント数字と矛盾しない地雷配置パターンを瞬時に列挙できます. 
    * **一意性判定**: 生成された解が「1つだけ」なら論理的に確定可能 , 「2つ以上」ならそのセルは運が必要（または情報不足）と判定されます. 

### 3. 難易度解析ロジック

#### A. $k$-Hint Difficulty (`HintCountCalculator`)
「いくつのヒントを同時に見れば解けるか」を指標化します. 
* **$k=1$**: 1つの数字を見るだけで確定する（基本手筋）. 
* **$k \ge 2$**: 2つ以上の数字を同時に考慮（連立方程式的推論）しないと解けない. 
* ソルバは $k$ 個のヒントの組み合わせを全探索し , DLXを用いて「その組み合わせだけで解が一意に定まる局所領域」を特定します. 

#### B. Technique Level Difficulty (`TechniqueAnalyzer`)
人間が使う解法テクニックをシミュレートします. 
* **Lv 1 (Base Hint)**: 残り地雷数＝空きマス数 , または地雷数＝0 の確定. 
* **Lv 2 (Subset / 包含)**: ヒントAの影響範囲がヒントBに含まれる場合 , 差分を確定させる（定石「1-1」「1-2」など）. 
* **Lv 3 (Intersection / 共通)**: 領域同士が部分的に重なる場合の推論. 

## プロジェクト構成

```text
src/
├── Main.java                # 統合実行クラス. 
│
├── PuzzleGenerator.java     # [生成] ランダム盤面生成. 
├── PuzzleMinimizer.java     # [生成] 一意解を維持したヒント削減. 
│
├── DancingLinks.java        # [Core] Algorithm X 実装. 解の探索・数え上げ. 
├── ConstraintBuilder.java   # [Core] マインスイーパ→Exact Cover行列変換. 
│
├── HintCountCalculator.java # [解析] k-Hint法の実装. 
├── TechniqueAnalyzer.java   # [解析] テクニックレベル法の実装. 
├── Region.java              # [解析] 領域演算ロジック. 
└── AnalysisLogger.java      # [Utility] CSVログ出力. 